---
//src/pages/workspace/[workspaceId]/boards.astro
export const prerender = false;
import UnifiedLayout from '../../../layouts/UnifiedLayout.astro';
import CreateBoardModal from '../../../components/board/CreateBoardModal.astro';
import BoardGrid from '../../../components/shared/BoardGrid.astro';
const { workspaceId } = Astro.params;

// Validar que workspaceId existe
if (!workspaceId) {
	throw new Error('Workspace ID is required');
}
---

<UnifiedLayout title="Tableros del Espacio de Trabajo">
	<div class="p-8">
		<div class="w-full px-6 md:px-12 xl:px-24 2xl:px-40">
			<!-- Header de la vista -->
			<div class="mb-12 pt-8">
				<h1 class="text-4xl font-extrabold text-gray-900 tracking-tight">
					Mis Tableros
				</h1>
				<p class="text-gray-600 mt-3 text-lg">
					Organiza tus proyectos y colabora con tu equipo
				</p>
			</div>

			<!-- Grid de boards usando el componente compartido -->
			<BoardGrid workspaceId={workspaceId} showCreateCard={true} gridId="boards-grid" enableRealTime={false} />
		</div>
	</div>

	<!-- Modal para crear board -->
	<CreateBoardModal workspaceId={workspaceId} />
</UnifiedLayout>

<script>
	import { initBoardGrid } from '../../../scripts/shared/board-grid';

	// Inicializar la vista de boards cuando el DOM esté listo
	document.addEventListener('DOMContentLoaded', () => {
		// workspaceId ya está validado en el frontmatter, pero por seguridad
		const workspaceId = new URLSearchParams(window.location.pathname.split('/').pop() || '').get('workspaceId') ||
		                   window.location.pathname.split('/').filter(Boolean).pop();

		if (workspaceId) {
			initBoardGrid('boards-grid', workspaceId, true, false);
		} else {
			console.error('No se pudo obtener el workspaceId');
		}
	});
</script>